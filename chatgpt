répartiton partie 3:

Paula; 3.2 et 3.5

Nour: 3.3 et 3.4

répartition partie 4:

Paula: 4.2

Nour: 4.1

OrganicEntity* Animal::updateState() {
    auto& env = getAppEnv();
    auto visibles = env.getEntitiesInSightForAnimal2(this);

    // 1. Si déjà en FEEDING, on vérifie la pause
    if (Etat == FEEDING) {
        if (tempsDepuisEtatChange.asSeconds() < getAppConfig().animal_eating_pause_time) {
            return this;  // Encore en train de manger
        } else {
            Etat = WANDERING;
        }
    }

    // 2. Analyse de l’environnement
    analyzeEnvironment(visibles);

    // 3. Reproduction (prioritaire)
    if (ciblePartenaire != nullptr) {
        if (Collider::isColliding(*ciblePartenaire)) {
            Etat = MATING;
        } else {
            Etat = MATE_IN_SIGHT;
        }
        return ciblePartenaire;
    }

    // 4. Alimentation
    if (cibleNourriture != nullptr) {
        if (Collider::isColliding(*cibleNourriture)) {
            Etat = FEEDING;
            tempsDepuisEtatChange = sf::Time::Zero;
            addEnergie(getAppConfig().animal_meal_retention);

            if (dynamic_cast<Animal*>(cibleNourriture)) { // si la cible est un animal
                cibleNourriture->setEnergie(0); // tue l’animal mangé
            } else { // si la cible est un cactus
                cibleNourriture->addEnergie(-getAppConfig().animal_meal_retention);
            }
        } else {
            Etat = FOOD_IN_SIGHT;
        }
        return cibleNourriture;
    }

    // 5. Rien en vue
    Etat = WANDERING;
    return this;
}
